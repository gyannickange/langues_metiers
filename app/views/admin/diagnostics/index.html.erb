<%# app/views/admin/diagnostics/index.html.erb %>
<div class="px-6 py-6">
  <h1 class="text-xl font-bold mb-6">Diagnostics</h1>
  <table class="w-full text-sm border-collapse">
    <thead><tr class="border-b text-left text-gray-500">
      <th class="pb-2 pr-4">Utilisateur</th>
      <th class="pb-2 pr-4">Statut</th>
      <th class="pb-2 pr-4">Profil principal</th>
      <th class="pb-2 pr-4">Créé le</th>
      <th></th>
    </tr></thead>
    <tbody>
      <% @diagnostics.each do |diagnostic| %>
        <tr class="border-b hover:bg-gray-50">
          <td class="py-2 pr-4"><%= diagnostic.user&.email %></td>
          <td class="pr-4">
            <span class="px-2 py-0.5 rounded text-xs font-medium
              <%= diagnostic.completed? ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600' %>">
              <%= diagnostic.status %>
            </span>
          </td>
          <td class="pr-4"><%= diagnostic.primary_profile&.name || "—" %></td>
          <td class="pr-4 text-gray-500"><%= diagnostic.created_at.strftime("%d/%m/%Y") %></td>
          <td class="text-right">
            <%= link_to "Voir", admin_diagnostic_path(diagnostic), class: "text-blue-600 text-xs" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <%== pagy_nav(@pagy) if @pagy.pages > 1 %>
</div>
