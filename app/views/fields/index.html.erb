<% content_for :title, t('fields.index.title') %>

<% content_for :header do %>
  <%= render 'fields_header' %>
<% end %>

<div class="min-h-screen bg-gray-50">

  <!-- R√©sultats -->
  <div class="container mx-auto px-4 py-8">
    <%= turbo_frame_tag "fields_results" do %>
      <% if @query.present? %>
        <div class="mb-6">
          <h2 class="text-2xl font-semibold text-gray-900">
            <%= t('fields.index.results_for') %> "<%= @query %>" 
            <span class="text-lg font-normal text-gray-500">(<%= @fields.count %> <%= @fields.count == 1 ? t('fields.index.result') : t('fields.index.results') %>)</span>
          </h2>
        </div>
      <% else %>
        <div class="mb-6">
          <h2 class="text-2xl font-semibold text-gray-900"><%= t('fields.index.all_fields') %></h2>
          <p class="text-gray-600"><%= t('fields.index.choose_field') %></p>
        </div>
      <% end %>

      <% if @fields.any? %>
        <div
          data-controller="lazy-list"
          data-lazy-list-batch-size-value="6">
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <% @fields.each do |field| %>
              <div data-lazy-list-target="item">
                <%= render "fields/field_card", field: field %>
              </div>
            <% end %>
          </div>
          <div class="hidden py-6 text-center text-sm text-gray-500" data-lazy-list-target="empty">
            <%= t('fields.index.lazy_empty') %>
          </div>
          <div class="mt-8 flex justify-center">
            <div class="h-8 w-full max-w-xs" data-lazy-list-target="sentinel"></div>
          </div>
        </div>
      <% else %>
        <div class="text-center py-12">
          <div class="text-gray-400 text-6xl mb-4">üîç</div>
          <h3 class="text-xl font-medium text-gray-900 mb-2">
            <%= @query.present? ? t('fields.index.no_results') : t('fields.index.no_fields_available') %>
          </h3>
          <% if @query.present? %>
            <p class="text-gray-600 mb-4"><%= t('fields.index.try_other_keywords') %></p>
            <%= link_to t('fields.index.view_all_fields'), fields_path, class: "text-primary hover:text-primary-600 font-medium" %>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
